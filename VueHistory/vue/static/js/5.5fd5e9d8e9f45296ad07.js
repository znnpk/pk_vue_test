webpackJsonp([5],{"/bqq":function(t,e){},QBPT:function(t,e){},vpEV:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l=s("RRo+"),o=s.n(l),r=s("Wxq9"),c=["小学","初中","高中","大学"],a={inject:["reload"],name:"SchManger",mounted:function(){},methods:{saveSch:function(){var t=this,e=this;if(console.log(this.schAddForm),""==this.schAddForm.schProv)return alert("学校省市区 为必填项哦！"),!1;this.$refs.schAddForm.validate(function(s){if(!s)return!1;t.$api.article.schManger("schSave",{schAddForm:t.schAddForm}).then(function(s){t.$notify.success({title:"成功",message:"记录已上传"}),t.schAddFormVisible=!1,e.reload()})})},handleChange:function(t){},pageList:function(){this.data=listJson.list,this.dateList=listJson.dateList,this.getList()},searchForSchInst:function(t,e){var s=!1;return t.schInst.forEach(function(t){t.name==e&&(s=!0)}),s},getList:function(){var t=this,e=this.data.filter(function(e,s){return e.schName.includes(t.searchData)||t.searchForSchInst(e,t.searchData)});this.list=e.filter(function(e,s){return s<t.page*t.limit&&s>=t.limit*(t.page-1)}),this.total=e.length},handleSizeChange:function(t){console.log("每页 "+t+" 条"),this.limit=t,this.getList()},handleCurrentChange:function(t){console.log("当前页: "+t),this.page=t,this.getList()},search:function(){this.page=1,this.getList()},dailogClose:function(t){this.$confirm("确认关闭？").then(function(e){t()}).catch(function(t){})},editSchForVisible:function(t){var e=this;this.schEditFormVisible=!0,this.$api.article.schManger("getSchBySchId",{schId:t.schId}).then(function(s){console.log("edit"),console.log(t.schId),200===s.code?(console.log(s.schEditForm),e.schEditForm=s.schEditForm,console.log("学校信息获取成功")):(console.log("学校数据获取失败"),e.$notify.error({title:"错误",message:"学校信息获取失败 稍后重试"}))})},updateSch:function(){var t=this,e=this;console.log(this.schEditForm),this.$refs.schEditForm.validate(function(s){if(!s)return!1;t.$api.article.schManger("updateSchBySchId",{schEditForm:t.schEditForm}).then(function(s){t.$notify.success({title:"成功",message:"记录修改成功"}),t.schEditFormVisible=!1,e.reload()})})},deleteSch:function(t){var e=this;this.$confirm("确认删除当前这条记录？").then(function(s){e.$api.article.schManger("deleteSchBySchId",{schId:t.schId}).then(function(t){200===t.code?(console.log("删除成功"),e.$notify.success({title:"成功",message:"删除成功"})):(console.log("删除失败"),e.$notify.error({dangerouslyUseHTMLString:!0,title:"错误",message:t.message})),e.reload()})}).catch(function(t){})},clearFilter:function(){this.$refs.schsShowTable.clearFilter(),this.searchData="",this.getList()},formatter:function(t,e){return t.address},filterTag:function(t,e){return e.schCorpIndiv===t},schInstFilter:function(t,e,s){var l=!1;return e[s.property].forEach(function(e){e.name==t&&(l=!0)}),l},filterHandler:function(t,e,s){return console.log(t),console.log("截断"),e[s.property]===t},toggleSelection:function(t){var e=this;t?t.forEach(function(t){e.$refs.schsShowTable.toggleRowSelection(t)}):this.$refs.schsShowTable.clearSelection()},handleSelectionChange:function(t){this.multipleSelection=t},tableRowClassName:function(t){t.row;return t.rowIndex%2==1?"warning-row":"success-row"}},data:function(){return{options:r.regionData,selectedOptions:[],rules:{rePassword:[{validator:"test",trigger:"blur"}],schContactorTele:[{required:!0,validator:function(t,e,s){var l=/^1[3|4|5|7|8][0-9]{9}$/;if(!e)return s();setTimeout(function(){o()(+e)?l.test(e)?s():s(new Error("电话号码格式不正确")):s(new Error("请输入数字值"))},100)},trigger:"blur"}]},textLabelWidth:"100px",cities:c,checkList:[],schLists:[],schEditForm:{schId:"",schName:"",schStudentNum:"",schTeacherNum:"",schCorpIndiv:"",schInst:[],schOpenTm:"",schAddr:"",schAdmin:"",schContactor:"",schContactorTele:"",schShortRsk:"",schRsk:"",schProv:"",schCity:"",schRegion:""},schAddForm:{schId:"",schName:"",schStudentNum:"",schTeacherNum:"",schCorpIndiv:"",schInst:[],schOpenTm:"",schAddr:"",schAdmin:"",schContactor:"",schContactorTele:"",schShortRsk:"",schRsk:"",schProv:"",schCity:"",schRegion:""},schEditFormVisible:!1,schAddFormVisible:!1,formLabelWidth:"120px",list:[],data:[],dateList:[],limit:5,total:null,page:1,searchData:""}},created:function(){var t=this;this.$api.article.schManger("getSchs",{userName:this.$store.state.userName}).then(function(e){console.log(e),t.data=e.schLists,t.getList()})}},i={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("el-row",[s("el-col",{attrs:{span:6}},[s("el-input",{attrs:{placeholder:"当前仅支持学校名称以及学制搜索"},model:{value:t.searchData,callback:function(e){t.searchData=e},expression:"searchData"}},[t._v(">")])],1),t._v(" "),s("el-col",{attrs:{span:2}},[s("el-button",{attrs:{icon:"el-icon-search",circle:""},on:{click:t.search}})],1),t._v(" "),s("el-button",{attrs:{type:"info"},on:{click:t.clearFilter}},[t._v("清除所有过滤器")]),t._v(" "),s("el-button",{attrs:{type:"success",round:""},on:{click:function(e){t.schAddFormVisible=!0}}},[t._v("新增")])],1),t._v(" "),s("el-dialog",{attrs:{title:"学校新增",visible:t.schAddFormVisible,width:"40%","before-close":t.dailogClose,center:""},on:{"update:visible":function(e){t.schAddFormVisible=e}}},[s("el-form",{ref:"schAddForm",attrs:{model:t.schAddForm,rules:t.rules,"label-width":"80px"}},[s("el-row",[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"校名"}},[s("el-input",{staticStyle:{width:"90%"},attrs:{required:""},model:{value:t.schAddForm.schName,callback:function(e){t.$set(t.schAddForm,"schName",e)},expression:"schAddForm.schName"}})],1)],1),t._v(" "),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"公私"}},[[s("div",[s("el-radio-group",{model:{value:t.schAddForm.schCorpIndiv,callback:function(e){t.$set(t.schAddForm,"schCorpIndiv",e)},expression:"schAddForm.schCorpIndiv"}},[s("el-radio-button",{attrs:{label:"公立"}}),t._v(" "),s("el-radio-button",{attrs:{label:"私立"}})],1)],1)]],2)],1)],1),t._v(" "),s("el-row",[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"教师人数"}},[s("el-input-number",{attrs:{min:0,max:999999,label:"描述文字"},model:{value:t.schAddForm.schTeacherNum,callback:function(e){t.$set(t.schAddForm,"schTeacherNum",e)},expression:"schAddForm.schTeacherNum"}})],1)],1),t._v(" "),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"学生人数"}},[s("el-input-number",{attrs:{min:0,max:999999,label:"描述文字"},model:{value:t.schAddForm.schStudentNum,callback:function(e){t.$set(t.schAddForm,"schStudentNum",e)},expression:"schAddForm.schStudentNum"}})],1)],1)],1),t._v(" "),s("el-row",[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"学制"}},[[s("div",{staticStyle:{"margin-top":"20px"}},[s("el-checkbox-group",{attrs:{size:"small"},model:{value:t.schAddForm.schInst,callback:function(e){t.$set(t.schAddForm,"schInst",e)},expression:"schAddForm.schInst"}},t._l(t.cities,function(e){return s("el-checkbox-button",{key:e,attrs:{label:e}},[t._v(t._s(e))])}),1)],1)]],2)],1),t._v(" "),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"创办时间"}},[s("el-date-picker",{attrs:{type:"date"},model:{value:t.schAddForm.schOpenTm,callback:function(e){t.$set(t.schAddForm,"schOpenTm",e)},expression:"schAddForm.schOpenTm"}})],1)],1)],1),t._v(" "),s("el-row",[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"校长"}},[s("el-input",{staticStyle:{width:"70%"},model:{value:t.schAddForm.schAdmin,callback:function(e){t.$set(t.schAddForm,"schAdmin",e)},expression:"schAddForm.schAdmin"}})],1)],1),t._v(" "),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"联系人"}},[s("el-input",{staticStyle:{width:"70%"},model:{value:t.schAddForm.schContactor,callback:function(e){t.$set(t.schAddForm,"schContactor",e)},expression:"schAddForm.schContactor"}})],1)],1)],1),t._v(" "),s("el-row",[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{prop:"schContactorTele",label:"联系电话"}},[s("el-input",{staticStyle:{width:"70%"},model:{value:t.schAddForm.schContactorTele,callback:function(e){t.$set(t.schAddForm,"schContactorTele",e)},expression:"schAddForm.schContactorTele"}})],1)],1),t._v(" "),s("el-col",{attrs:{span:12}},[s("el-form-item",{staticStyle:{"margin-left":"-20px"},attrs:{label:"学校省市区","label-width":t.textLabelWidth}},[[s("div",[s("el-cascader",{attrs:{size:"large",options:t.options,props:{expandTrigger:"hover"}},on:{change:t.handleChange},model:{value:t.schAddForm.schProv,callback:function(e){t.$set(t.schAddForm,"schProv",e)},expression:"schAddForm.schProv"}})],1)]],2)],1)],1),t._v(" "),s("el-row",[s("el-col",[s("el-form-item",{attrs:{label:"地址"}},[s("el-input",{staticStyle:{width:"90%"},model:{value:t.schAddForm.schAddr,callback:function(e){t.$set(t.schAddForm,"schAddr",e)},expression:"schAddForm.schAddr"}})],1)],1)],1),t._v(" "),s("el-row",[s("el-col",{attrs:{span:400}},[s("el-form-item",{staticStyle:{width:"95%"},attrs:{label:"备注"}},[s("el-input",{staticClass:"date_picker",attrs:{type:"textarea"},model:{value:t.schAddForm.schRsk,callback:function(e){t.$set(t.schAddForm,"schRsk",e)},expression:"schAddForm.schRsk"}})],1)],1)],1)],1),t._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){t.schAddFormVisible=!1}}},[t._v("取 消")]),t._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:t.saveSch}},[t._v("提 交")])],1)],1),t._v(" "),s("el-table",{ref:"schsShowTable",staticStyle:{width:"100%"},attrs:{data:t.list,"row-class-name":t.tableRowClassName,"default-sort":{prop:"name",order:"descending"},border:"","tooltip-effect":"dark"},on:{"selection-change":t.handleSelectionChange}},[s("el-table-column",{attrs:{sortable:"",prop:"schName",label:"校名",width:"auto"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[s("el-tag",{attrs:{size:"medium"}},[t._v(t._s(e.row.schName))])],1)]}}])}),t._v(" "),s("el-table-column",{attrs:{sortable:"",prop:"schStudentNum",label:"学生人数",width:"110"}}),t._v(" "),s("el-table-column",{attrs:{sortable:"",prop:"schTeacherNum",label:"教师人数",width:"110"}}),t._v(" "),s("el-table-column",{attrs:{sortable:"",prop:"schCorpIndiv",label:"公私立制",width:"120",filters:[{text:"公立",value:"公立"},{text:"私立",value:"私立"}],"filter-method":t.filterTag,"filter-placement":"bottom-end"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-tag",{attrs:{type:"公立"===e.row.tag?"primary":"success","disable-transitions":""}},[t._v(t._s(e.row.schCorpIndiv))])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"schInst",label:"学制",width:"120",filters:[{text:"小学",value:"小学"},{text:"初中",value:"初中"},{text:"高中",value:"高中"},{text:"大学",value:"大学"}],"filter-method":t.schInstFilter},scopedSlots:t._u([{key:"default",fn:function(e){return[s("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},t._l(e.row.schInst,function(e){return s("el-tag",{key:e.name,attrs:{type:e.type}},[t._v("\n              "+t._s(e.name)+"\n            ")])}),1)]}}])}),t._v(" "),s("el-table-column",{attrs:{sortable:"",prop:"schOpenTm",label:"创办时间",width:"auto"}}),t._v(" "),s("el-table-column",{attrs:{prop:"schAdmin",label:"校长",width:"90"}}),t._v(" "),s("el-table-column",{attrs:{prop:"schContactor",label:"联系人",width:"90"}}),t._v(" "),s("el-table-column",{attrs:{prop:"schContactorTele",label:"联系人电话",width:"90"}}),t._v(" "),s("el-table-column",{attrs:{prop:"schAddr",label:"地址",width:"90"}}),t._v(" "),s("el-table-column",{attrs:{prop:"schProv",label:"省份",width:"90"}}),t._v(" "),s("el-table-column",{attrs:{prop:"schCity",label:"地市",width:"90"}}),t._v(" "),s("el-table-column",{attrs:{prop:"schRegion",label:"区县",width:"90"}}),t._v(" "),s("el-table-column",{attrs:{prop:"schRsk",label:"备注",width:"auto"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-popover",{attrs:{trigger:"hover",placement:"top"}},[s("p",[t._v(t._s(e.row.schRsk))]),t._v(" "),s("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[s("el-tag",{attrs:{size:"medium"}},[t._v(t._s(e.row.schShortRsk))])],1)])]}}])}),t._v(" "),s("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:"",size:"small"},on:{click:function(s){return t.editSchForVisible(e.row)}}}),t._v(" "),s("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:"",size:"small"},on:{click:function(s){return t.deleteSch(e.row)}}})]}}])})],1),t._v(" "),s("el-dialog",{attrs:{title:"学校编辑",visible:t.schEditFormVisible,width:"40%","before-close":t.dailogClose,center:""},on:{"update:visible":function(e){t.schEditFormVisible=e}}},[s("el-form",{ref:"schEditForm",attrs:{model:t.schEditForm,rules:t.rules,"label-width":"80px"}},[s("el-row",[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"校名"}},[s("el-input",{staticStyle:{width:"90%"},attrs:{required:""},model:{value:t.schEditForm.schName,callback:function(e){t.$set(t.schEditForm,"schName",e)},expression:"schEditForm.schName"}})],1)],1),t._v(" "),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"公私"}},[[s("div",[s("el-radio-group",{model:{value:t.schEditForm.schCorpIndiv,callback:function(e){t.$set(t.schEditForm,"schCorpIndiv",e)},expression:"schEditForm.schCorpIndiv"}},[s("el-radio-button",{attrs:{label:"公立"}}),t._v(" "),s("el-radio-button",{attrs:{label:"私立"}})],1)],1)]],2)],1)],1),t._v(" "),s("el-row",[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"教师人数"}},[s("el-input-number",{attrs:{min:0,max:999999,label:"描述文字"},model:{value:t.schEditForm.schTeacherNum,callback:function(e){t.$set(t.schEditForm,"schTeacherNum",e)},expression:"schEditForm.schTeacherNum"}})],1)],1),t._v(" "),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"学生人数"}},[s("el-input-number",{attrs:{min:0,max:999999,label:"描述文字"},model:{value:t.schEditForm.schStudentNum,callback:function(e){t.$set(t.schEditForm,"schStudentNum",e)},expression:"schEditForm.schStudentNum"}})],1)],1)],1),t._v(" "),s("el-row",[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"学制"}},[[s("div",{staticStyle:{"margin-top":"20px"}},[s("el-checkbox-group",{attrs:{size:"small"},model:{value:t.schEditForm.schInst,callback:function(e){t.$set(t.schEditForm,"schInst",e)},expression:"schEditForm.schInst"}},t._l(t.cities,function(e){return s("el-checkbox-button",{key:e,attrs:{label:e}},[t._v(t._s(e))])}),1)],1)]],2)],1),t._v(" "),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"创办时间"}},[s("el-date-picker",{attrs:{type:"date"},model:{value:t.schEditForm.schOpenTm,callback:function(e){t.$set(t.schEditForm,"schOpenTm",e)},expression:"schEditForm.schOpenTm"}})],1)],1)],1),t._v(" "),s("el-row",[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"校长"}},[s("el-input",{staticStyle:{width:"70%"},model:{value:t.schEditForm.schAdmin,callback:function(e){t.$set(t.schEditForm,"schAdmin",e)},expression:"schEditForm.schAdmin"}})],1)],1),t._v(" "),s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"联系人"}},[s("el-input",{staticStyle:{width:"70%"},model:{value:t.schEditForm.schContactor,callback:function(e){t.$set(t.schEditForm,"schContactor",e)},expression:"schEditForm.schContactor"}})],1)],1)],1),t._v(" "),s("el-row",[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{prop:"schContactorTele",label:"联系电话"}},[s("el-input",{staticStyle:{width:"70%"},model:{value:t.schEditForm.schContactorTele,callback:function(e){t.$set(t.schEditForm,"schContactorTele",e)},expression:"schEditForm.schContactorTele"}})],1)],1),t._v(" "),s("el-col",{attrs:{span:12}},[s("el-form-item",{staticStyle:{"margin-left":"-20px"},attrs:{label:"学校省市区","label-width":t.textLabelWidth}},[[s("div",{attrs:{id:"app"}},[s("el-cascader",{attrs:{size:"large",options:t.options,props:{expandTrigger:"hover"}},on:{change:t.handleChange},model:{value:t.schEditForm.schProv,callback:function(e){t.$set(t.schEditForm,"schProv",e)},expression:"schEditForm.schProv"}})],1)]],2)],1)],1),t._v(" "),s("el-row",[s("el-col",[s("el-form-item",{attrs:{label:"地址"}},[s("el-input",{staticStyle:{width:"90%"},model:{value:t.schEditForm.schAddr,callback:function(e){t.$set(t.schEditForm,"schAddr",e)},expression:"schEditForm.schAddr"}})],1)],1)],1),t._v(" "),s("el-row",[s("el-col",{attrs:{span:400}},[s("el-form-item",{staticStyle:{width:"95%"},attrs:{label:"备注"}},[s("el-input",{staticClass:"date_picker",attrs:{type:"textarea"},model:{value:t.schEditForm.schRsk,callback:function(e){t.$set(t.schEditForm,"schRsk",e)},expression:"schEditForm.schRsk"}})],1)],1)],1)],1),t._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){t.schEditFormVisible=!1}}},[t._v("取 消")]),t._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:t.updateSch}},[t._v("提 交")])],1)],1),t._v(" "),s("div",{staticClass:"block"},[s("el-pagination",{attrs:{"hide-on-single-page":!0,background:"","current-page":t.page,"page-sizes":[1,2,5,10],"page-size":t.limit,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)},staticRenderFns:[]};var n=s("VU/8")(a,i,!1,function(t){s("QBPT"),s("/bqq")},"data-v-8f8b37de",null);e.default=n.exports}});
//# sourceMappingURL=5.5fd5e9d8e9f45296ad07.js.map